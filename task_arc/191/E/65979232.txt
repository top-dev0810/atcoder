#include<bits/stdc++.h>
#define ll long long
#define pb push_back
using namespace std;
const int N=200005,mod=998244353;
int n,X,Y,a[N],b[N],c[4];
ll fc[N],iv[N],ans,pw[N],s[N];
void init(){
	fc[0]=iv[0]=iv[1]=1;
	for(int i=2;i<=n;i++) iv[i]=iv[mod%i]*(mod-mod/i)%mod;
	for(int i=1;i<=n;i++) fc[i]=fc[i-1]*i%mod,iv[i]=iv[i-1]*iv[i]%mod;
}
ll C(int n,int m){
	return fc[n]*iv[m]%mod*iv[n-m]%mod;
}
int main(){
	scanf("%d%d%d",&n,&X,&Y),pw[0]=1;
	for(int i=1;i<=n;i++) pw[i]=pw[i-1]*2%mod;
	for(int i=1;i<=n;i++){
		scanf("%d%d",&b[i],&a[i]);
		if(a[i]&1){
			if(b[i]<=1) c[0]++;
			else c[1]++;
		}
		else{
			if(!b[i]) c[2]++;
			else c[3]++;
		}
	}
	init();
	X%=2,Y%=2;
	if(X&&Y){
		int half=(c[0]+c[1])/2+1;
		for(int i=half;i<=c[0]+c[1];i++) (ans+=C(c[0]+c[1],i)*pw[c[2]+c[3]])%=mod;
	}
	else if(Y){
		for(int i=c[1]+c[3];i>=0;i--) s[i]=(s[i+1]+C(c[1]+c[3],i))%mod;
		for(int i=0;i<=c[0];i++) (ans+=s[max(c[0]-2*i+1,0)]*C(c[0],i))%=mod;
		ans=ans*pw[c[2]]%mod;
	}
	else if(X){
		for(int i=0;i<=c[1]+c[3];i++) s[i]=((i?s[i-1]:0)+C(c[1]+c[3],i))%mod;
		for(int i=0;i<=c[0];i++) (ans+=(2*i-c[0]-1>=0?s[min(2*i-c[0]-1,c[1]+c[3])]:0)*C(c[0],i))%=mod;
		ans=ans*pw[c[2]]%mod;
	}
	else{
		c[0]=c[1]=0;
		for(int i=1;i<=n;i++){
			(a[i]+=b[i])%=2;
			if(a[i]&1) c[0]++;
			else c[1]++;
		}
		int half=c[0]/2+1;
		for(int i=half;i<=c[0];i++) (ans+=C(c[0],i)*pw[c[1]])%=mod;
	}
	printf("%lld\n",ans);
	return 0;
}