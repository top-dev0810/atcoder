#include <bits/stdc++.h>

using namespace std;

typedef __int128 lnt;

const int N = 5e5 + 7;

int a[N];
lnt las;

lnt calc(lnt n, lnt a, lnt b, lnt c) {
    lnt s[] = { 0, 0 };
    int t = 0;
    lnt n1;
    while (~a) {
        lnt d = __gcd(a, __gcd(b, c));
        a /= d;
        b /= d;
        c /= d;
        n1 = n + 1;
        if (a == 0) {
            s[t] += (b / c) * n1;
            a = -1;
        } else if (a >= c || b >= c) {
            s[t] += n * n1 / 2 * (a / c) + (b / c) * n1;
            a %= c;
            b %= c;
        } else {
            lnt m = (a * n + b) / c;
            s[t] += n * m;
            t ^= 1;
            n = m - 1;
            b = c - b - 1;
            swap(a, c);
        }
    }
    return las = s[0] - s[1];
}

long long rd() {
    long long x;
    cin >> x;
    return x;
}

void INIT() { }

void WORK() {
    lnt n, m, c, k;
    n = rd();
    m = rd();
    c = rd();
    k = rd();
    for (int i = 0; i < n; ++ i) {
        cin >> a[i];
    }
    sort(a, a + n);
    n = unique(a, a + n) - a;
    lnt ans = c * (k - 1) * k / 2 + a[0] * k - calc(k - 1, c, a[0], m) * m;
    for (int i = 1; i < n; ++ i) {
        lnt s = -las;
        s += calc(k - 1, c, a[i], m);
        ans += s * (a[i] - a[0] - m);
    }
    cout << (long long) ans << '\n';
}

//#define filename ""

int main() {
    #ifdef filename
    freopen(filename ".in", "r", stdin);
    freopen(filename ".out", "w", stdout);
    #endif
    cin.tie(0); cout.tie(0);
    ios::sync_with_stdio(0);
    
    INIT();
    int Turn = 1;
    //cin >> Turn;
    while (Turn -- ) {
        WORK();
    }
    return 0;
}