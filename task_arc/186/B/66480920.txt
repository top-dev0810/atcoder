#include<bits/stdc++.h>
#define Maxn 300005
#define LL long long
using namespace std;
const int md = 998244353;
LL ksm(LL x, LL y){
	LL z=1;
	while(y){
		if(y&1) z=z*x%md;
		x=x*x%md; y>>=1;
	}
	return z;
}

int n,a[Maxn];
vector<int> e[Maxn],g[Maxn];
LL ans;

void dfs1(int x){
	if(e[x].empty()) return;
	for(int y : e[x]){
		dfs1(y);
	}
	for(int i=e[x].size()-2; ~i; i--){
		g[e[x][i+1]].emplace_back(e[x][i]);
	}
	g[x].emplace_back(e[x].back());
}
int siz[Maxn];
void dfs2(int x){
	siz[x] = 1;
	for(int y : g[x]){
		dfs2(y);
		siz[x] += siz[y];
	}
	(ans *= ksm(siz[x], md-2)) %= md;
}

int main(){
	scanf("%d",&n);
	ans = n+1;
	for(int i=1; i<=n; i++){
		scanf("%d",a+i);
		e[a[i]].emplace_back(i);
		(ans *= i) %= md;
	}
	
	dfs1(0);
	dfs2(0);
	printf("%lld",ans);
	return 0;
}
