#include<bits/stdc++.h>
#define int long long
#define maxn 1000005
using namespace std;
const int inf=1e16;
int n,m,x,y,a[maxn],b[maxn],c[maxn],t[maxn];
int read(){
	int ret=0,f=1;char ch=getchar();
	while (ch<'0'||ch>'9'){if (ch=='-') f=-f;ch=getchar();}
	while (ch<='9'&&ch>='0') ret=ret*10+ch-'0',ch=getchar();
	return ret*f;
}
bool check(int mid){
	int nowx=x,nowy=y;
	for (int i=1;i<=n;i++) if (b[i]<a[i]+c[i]) nowx+=min(a[i],b[i]);
	if (nowx<mid) return 0;
	for (int i=1;i<=n;i++) if (b[i]<a[i]+c[i]){
		nowy+=min(b[i]-min(a[i],b[i]),c[i])+min(nowx-mid,min(min(a[i],b[i]),c[i]-min(b[i]-min(a[i],b[i]),c[i])));
		nowx-=min(nowx-mid,min(min(a[i],b[i]),c[i]-min(b[i]-min(a[i],b[i]),c[i])));
	}
	return nowy>=mid;
}
signed main(){
	int T=read();
	while (T--){
		n=read(),x=y=0;
		for (int i=1;i<=n;i++){
			a[i]=read(),b[i]=read(),c[i]=read();
			if (b[i]>=a[i]+c[i]) x+=a[i],y+=c[i];
		}
		int L=1,R=1e15,cnt=0;
		while (L<=R){
			int mid=L+R>>1;
			if (check(mid)) L=mid+1,cnt=mid;
			else R=mid-1;
		}
		printf("%lld\n",cnt);
	}
	return 0;
}