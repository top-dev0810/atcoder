#include<bits/stdc++.h>
using namespace std;
const int N=3005,mod=998244353;
typedef long long ll;
int n,s,l,r,a[N],b[N],p[N],t[N],c[N];
bool v[N],ex[N*2];ll fc[N],iv[N],f[N],tl,ans;
#define ck(x) ((tl=x)>=mod?tl-mod:tl)

ll inv(ll a){
	ll b=mod-2,c=1;while(b){
		if(b&1)c=c*a%mod;a=a*a%mod;b>>=1;
	}return c;
}

ll ch(int x,int y){
	return fc[x]*iv[y]%mod*iv[x-y]%mod;
}

int main(){
	ios::sync_with_stdio(false);
	cin.tie(0); cout.tie(0); cin>>n;
	for(int i=1;i<=n;i++)cin>>a[i],ex[a[i]]=1; int pt,c1,c2;
	for(int i=1;i<=n;i++){
		cin>>b[i];if(b[i]>0)p[(b[i]+1)/2]=i;
	}fc[0]=1;for(int i=1;i<=n;i++)fc[i]=fc[i-1]*i%mod;
	iv[n]=inv(fc[n]);for(int i=n-1;i>=0;i--)iv[i]=iv[i+1]*(i+1)%mod;
	for(int i=1;i<=n*2;i+=2)if(ex[i]&&ex[i+1]){cout<<"0\n";return 0;}
	for(int i=1;i<=n;i++)
		t[i]=p[(a[i]+1)/2],c[p[(a[i]+1)/2]]++;
	for(int i=1;i<=n;i++)
		if(!c[i]){
			pt=i,c1=c2=0;
			while(pt){
				if(a[pt]&1)c1++;else c2++;
				v[pt]=1;pt=t[pt];
			}s++,l+=!c2,r+=!c1;
		}
	for(int i=1;i<=n;i++)
		if(!v[i]){
			pt=i,c1=c2=0;
			while(1){
				if(a[pt]&1)c1++;else c2++;
				v[pt]=1;pt=t[pt];if(pt==i)break;
			}if(!c1||!c2){cout<<"0\n";return 0;}
		}
//	cout<<s<<" "<<l<<" "<<r<<"\n";
	f[0]=1;for(int i=1;i<=s;i++)
		for(int j=1;j<=i;j++)
			f[i]=ck(f[i]+f[i-j]*fc[i-1]%mod*iv[i-j]%mod*(mod-1)%mod);
	for(int i=0;i<=l;i++)
		for(int j=0;j<=r;j++)
			ans=ck(ans+ch(l,i)*ch(r,j)%mod*f[i]%mod*f[j]%mod*fc[s-i-j]%mod);
	cout<<ans<<"\n";return 0;
}