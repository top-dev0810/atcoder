#include<bits/stdc++.h>
using namespace std;
int n,m,k,t,tt,a[1005],b[1005];
bool ask(int x,int y){
	cout<<"? "<<x+1<<" "<<y+1<<endl;
	cin>>x;
	return x;
}
int main(){
	ios::sync_with_stdio(false),cin.tie(0),cout.tie(0);
	cin>>n>>m>>tt;
	k=m+1;
	b[(n-1)/k*k]=1;
	for(int i=0;i<n;i++)if(i%k>0){
		a[i]=ask(i-i%k,i);
		b[i-i%k]|=a[i];
	}
	for(int i=0;i<n;i+=k)if(!b[i]){
		t=i;
		break;
	}
	for(int i=0;i<n;i+=k)if(b[i]&&ask(t,i))for(int j=0;j<k;j++)a[i+j]^=1;
	cout<<"! ";
	for(int i=0;i<n;i++)if(a[i])cout<<i+1<<(i+1==n?"\n":" ");
	cout<<endl;
	return 0;
}