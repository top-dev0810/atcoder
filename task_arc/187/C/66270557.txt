#include<bits/stdc++.h>
using namespace std;
typedef long long ll;
const int N=5005,mod=998244353;
ll a[N],cnt[N],f[N],g[N],h[N];
bool ban[N];
ll n;

int main(){
	cin>>n;
	for(int i=1;i<=n;i++)cin>>a[i];
	for(int i=1;i<=n;i++)if(a[i]!=-1)ban[a[i]]=1;
	for(int i=1;i<=n;i++) cnt[i]=cnt[i-1]+(ban[i]==0),f[i]=1;
	for(int t=1,w=0;t<n;w+=a[t++]==-1){
		memcpy(g,f,sizeof(g));memset(f,0,sizeof(f));
		for(int i=1;i<=n;i++) h[i]=(h[i-1]+(ban[i]==0)*g[i])%mod;
		for(int i=1;i<=n;i++){
			if(a[t]==-1) f[i]=(g[i]*(cnt[i-1]-w)+h[i-1])%mod;
			else if(i>a[t]) f[i]=(g[i]+g[a[t]])%mod;
		}
	}
	cout<<f[n];
}