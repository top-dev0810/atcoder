#include<bits/stdc++.h>
using namespace std;
typedef long long ll;
typedef pair<int,int> pii;
int n , m , k;
const int N = 2e5 + 5;
int a[N] , b[N];
void solv()
{
    cin >> n;
    for(int i = 1;i <= n;i++) cin >> a[i];
    for(int i = 1;i <= n;i++) cin >> b[i];
    if(accumulate(a + 1 , a + n + 1 , 0) != accumulate(b + 1 , b + n + 1 , 0)) cout << "No\n";
    else {
        int c = accumulate(a + 1 , a + n + 1 , 0) ;
        if(c == 1) {
            int pa , pb;
            if(a[1]) pa = 1;
            else if(a[n]) pa = 2;
            else pa = 3;

            if(b[1]) pb = 1;
            else if(b[n]) pb = 2;
            else pb = 3;
            if(pa != pb) cout << "No\n";
            else cout << "Yes\n";
        }
        else cout << "Yes\n";
    }
    return;
}
int main()
{
    ios::sync_with_stdio(false) ; cin.tie(0) ; cout.tie(0) ;
    int T;cin >> T;
    while(T--) solv();
    return 0;
}