// LUOGU_RID: 162652642
#include<bits/stdc++.h>
#define ll long long
#define mod 998244353
#define N 200005 
using namespace std;
inline ll qmi(ll a,ll b,ll p){
	ll res = 1%p,t = a;
	while(b){
		if(b&1) res=res*t%p;
		t=t*t%p;
		b>>=1;
	}
	return res;
}
vector<ll> op[N];
ll n,m,i,x,y,Q,P,ansq,ansp,sta[N],top,tr[N],sum,pw[N],qzh[N],qzh2[N],now;
char s[N];
inline void add(ll k,ll x){
	k++,sta[++top]=k;
	while(k<=n) tr[k]+=x,k+=k&(-k);
}
inline ll query(ll k){
	k++;
	ll num = 0;
	while(k) num+=tr[k],k-=k&(-k);
	return num;
}
inline void clear(){
	for(ll i=1;i<=top;i++) for(ll j=sta[i];j<=n;j+=j&(-j)) tr[j]=0;
	top=0;
}
inline void solve(vector<ll> pos){
	if(pos.size()==0){
		ansp = sum,ansq = sum*(sum-1)%mod*qmi(2,mod-2,mod)%mod;
		return ;
	}
	for(ll i=0;i<pos.size();i++) add(pos[i],1);
	ll beg = pos[0],com = 0;
	for(ll i=0;i<pos.size();i++) com+=(s[pos[i]]=='1');
	if(beg>0){
		if(com%2==0) ansp = (ansp+qzh[beg-1])%mod,ansq=(ansq+qzh2[beg-1])%mod;
		else ansp = (ansp-qzh[beg-1])%mod,ansq=(ansq-qzh2[beg-1])%mod;
	}
	if(s[beg]=='1'){
		if((com-1)%2==0) ansp = (ansp+qzh[beg]-(beg!=0?qzh[beg-1]:0)+mod)%mod,ansq=(ansq+qzh2[beg]-(beg!=0?qzh2[beg-1]:0)+mod)%mod;
		else ansp = (ansp-qzh[beg]+(beg!=0?qzh[beg-1]:0)+mod)%mod,ansq=(ansq-qzh2[beg]+(beg!=0?qzh2[beg-1]:0))%mod;
	}
//	cout<<"?? "<<ansq<<endl;
	ll cnt = qmi(2,beg,mod);
	if(pos.size()==1) ansq = (ansq-(qzh[n]-qzh[beg]+mod)%mod*cnt%mod*qmi(2,mod-2,mod)%mod+mod)%mod;
	else{
		ll nex = pos[1];
		if((com-1+(s[beg]=='1'))%2==0) ansq=(ansq+(qzh[nex-1]-qzh[beg]+mod)%mod*cnt%mod*qmi(2,mod-2,mod)%mod)%mod;
		else ansq=(ansq-(qzh[nex-1]-qzh[beg]+mod)%mod*cnt%mod*qmi(2,mod-2,mod)%mod)%mod;
		if(s[nex]=='1'){
			if((com-1+(s[beg]!='1'))%2==0) ansq=(ansq+pw[nex]*cnt%mod*qmi(2,mod-2,mod)%mod)%mod;
			else ansq=(ansq-pw[nex]*cnt%mod*qmi(2,mod-2,mod)%mod)%mod;
		}
	}
	ansp = (ansp%mod+mod)%mod,ansq = (ansq%mod+mod)%mod;
	clear();
}
int main(){
	ios::sync_with_stdio(false);
	cin>>n>>m>>(s+1);
	pw[0]=1;
	for(i=1;i<=n;i++) pw[i]=pw[i-1]*2%mod;
	for(i=1;i<=n;i++) sum=sum*2%mod,sum=(sum+(s[i]=='1'))%mod;
	reverse(s+1,s+n+1);
	for(i=0;i<=n;i++) s[i]=s[i+1];
	s[n]='0';
	for(i=0;i<=n;i++) qzh[i]=(s[i]=='0'?0:pw[i]);
	for(i=1;i<=n;i++) qzh[i]=(qzh[i]+qzh[i-1])%mod;
	for(i=0;i<=n;i++) if(s[i]=='1') qzh2[i]=pw[i]*(qzh[n]-qzh[i]+mod)%mod,qzh2[i]=(qzh2[i]+(pw[i]*(pw[i]-1)%mod*qmi(2,mod-2,mod)%mod))%mod,now=(now+pw[i])%mod;
//	cout<<"qzh2 is\n";
//	for(i=0;i<=n;i++) cout<<qzh2[i]<<" ";
//	cout<<endl;
	for(i=1;i<=n;i++) qzh2[i]=(qzh2[i]+qzh2[i-1])%mod;
	for(i=1;i<=m;i++){
		cin>>x;
		while(x--) cin>>y,op[i].push_back(y);
	}
	for(i=1;i<=m;i++){
		ansq=ansp=0;
		solve(op[i]);
//		cout<<"! "<<ansq<<endl;		
		ansp=(ansp+sum)%mod*qmi(2,mod-2,mod)%mod;
		ansq=(ansq+sum*(sum-1)%mod*qmi(2,mod-2,mod)%mod)%mod*qmi(2,mod-2,mod)%mod;
		P=(P+ansp)%mod;
		Q=(Q+ansq*m+ansp*(i-1))%mod;
	}
	P=P*(P-1+mod)%mod*qmi(2,mod-2,mod)%mod;
	cout<<(Q-P+mod)%mod<<endl;
	return 0;
}