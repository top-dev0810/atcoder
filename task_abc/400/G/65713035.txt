#include<bits/stdc++.h>
using namespace std;
#define int long long
const int N=2e5+9;
int T,n,k,a[N][3];
#define fi first
#define se second
#define mp make_pair
pair<int,int> f[N][10];
int check(int x){
	for(int p=1;p<8;p++) f[0][p]=mp(-1e18,0);
	f[0][0]=mp(0,0);
	for(int i=1;i<=n;i++)for(int p=0;p<8;p++){
		f[i][p]=f[i-1][p];
		for(int j=0;j<3;j++) f[i][p]=max(f[i][p],mp(f[i-1][p^(1<<j)].fi+2*a[i][j]+x,f[i-1][p^(1<<j)].se+1));
	}
	return f[n][0].se;
}
int solve(){
	cin>>n>>k;
	for(int i=1;i<=n;i++)for(int j=0;j<3;j++) cin>>a[i][j];
	int l=-2e9,r=0,ans=0;
	while(l<=r){
		int mid=(l+r)/2;
		if(check(mid)>=2*k) r=mid-1,ans=mid;
		else l=mid+1;
	}
	check(ans);
	return (f[n][0].fi-ans*2*k)/2;
}
signed main(){
	cin>>T;
	while(T--) cout<<solve()<<endl;
	return 0;
}