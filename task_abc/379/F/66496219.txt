#include <bits/stdc++.h>
using namespace std;
typedef long long ll;



int main() {
  ios::sync_with_stdio(0);
  cin.tie(0);
  int n, q, a, b;
  cin >> n >> q;
  vector<int> h(n+1);
  vector<vector<pair<int, int>>> qs(n+1);
  vector<int> ans(q);
  for(int i = 1; i <= n; i++) {
    cin >> h[i];
  }
  for(int i = 0; i < q; i++) {
    cin >> a >> b;
    qs[a].push_back({b, i});
  }
  vector<int> st;
  for(int i = n; i > 0; i--) {
    for(auto [r, qi] : qs[i]) {
      ans[qi] = lower_bound(st.begin(), st.end(), r, greater<int>())-st.begin();
    }
    
    while(!st.empty() && h[st.back()] < h[i]) {
      st.pop_back();
    }
    st.push_back(i);
  }
  for(int i = 0; i < q; i++) cout << ans[i] << "\n";
  
  return 0;
}