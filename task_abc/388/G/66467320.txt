#include<bits/stdc++.h>
using namespace std;
#define int long long
#define PII pair<int,int>
#define LL long long
#define endl "\n"

const int N=5e5+10;
const int mod=1e9+7;
int a[N],p[N];
int f[N][25],LOG[N];
int get(int l,int r) {
    int k=LOG[r-l+1];
    return max(f[l][k],f[r-(1ll<<k)+1][k]);
}
void solve() {
    int n;
    cin>>n;
    for(int i=1;i<=n;i++) cin>>a[i];
    for(int i=2;i<=n;i++) LOG[i]=LOG[i/2]+1;
    for(int i=1;i<=n;i++) {
        int pos=lower_bound(a+1,a+n+1,a[i]*2)-a;
        if(pos==n+1) {
            p[i]=1e18;
        } else {
            p[i]=pos;
        }
    }
    for(int i=1;i<=n;i++) p[i]+=n-i;
    for(int i=1;i<=n;i++) f[i][0]=p[i];
    for(int j=1;j<=18;j++) {
        for(int i=1;i+(1ll<<j)-1<=n;i++) {
            f[i][j]=max(f[i][j-1],f[i+(1ll<<(j-1))][j-1]);
        }
    }
    int q;
    cin>>q;
    while(q--) {
        int l,r;
        cin>>l>>r;
        int ans=0,L=0,R=(r-l+1)/2;
        while(L<=R) {
            int mid=L+R>>1;
            int maxn=get(l,l+mid-1);
            if(maxn<=n+r-l+1-mid) ans=mid,L=mid+1;
            else R=mid-1;
        }
        cout<<ans<<endl;
    }
}   
signed main() {
    int T=1;
    ios::sync_with_stdio(false);
    cin.tie(0);
    cout.tie(0);
    // cin>>T;
    while(T--) {    
        solve();
    }
}